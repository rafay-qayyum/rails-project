<head>
  <title><%= @course.title %></title>
  <%= stylesheet_link_tag 'show_course.css' %>
</head>
<body>
  <div class="course-container">

    <div class="course-header">
      <h1><%= @course.title %></h1>
      <p class="instructor">Instructor: <%= @course.instructor.name %></p>
    </div>

    <div class="course-details">
      <div class="course-description">
        <p><%= @course.description %></p>
      </div>

      <div class="course-image">
        <%= image_tag @course.image %>
      </div>
    </div>

    <div class="course-info">
      <p class="price"><b>Price:</b> <%= number_to_currency(@course.price) %></p>
      <p class="language"><b>Language:</b> <%= @course.language %></p>
      <p class="requirements"><b>Requirements:</b> <%= @course.requirements %></p>
    </div>

    <div class="chapters">
      <h2>Chapters</h2>

      <ol>
        <% @course.chapters.each do |chapter| %>
          <% if can? :read, chapter %>
            <li><%=button_to chapter.name, course_chapter_path(@course, chapter), class: "chapter-button", method: :get %></li>
          <% else %>
            <li><%= chapter.name %></li>
          <% end %>
          <br>
        <% end %>
      </ol>

      <br>
      <%if can? :manage, @course%>
        <%= button_to "Create New Chapter", new_course_chapter_path(@course), class: "btn-primary", method: :get %>
      <%end%>
    </div>

  </div>
  <br><br>

  <% if can? :manage, @course %>
      <%= link_to "Back to Course Catalog", authenticated_instructor_root_path, class:"button"%>
      <%= link_to "Edit Course", edit_course_path(@course), class:"button" %>
      <%= link_to "Delete Course", course_path(@course), class:"button", data: { 'turbo-method': :delete, turbo_confirm: "Are you sure?" }%>
  <% else %>
      <%= link_to "Back to Course Catalog", authenticated_instructor_root_path, class:"button"%>
  <% end %>

  <% if can? :create, Enrollment and !current_student.enrollments.find_by(course_id: @course.id) %>
    <%= link_to "Enroll", course_enrollments_path(@course), class:"button", data: { 'turbo-method': :post }%>
  <% end %>
</body>
